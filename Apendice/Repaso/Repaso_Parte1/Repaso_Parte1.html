
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Repaso Parte 1 - Introducción a los métodos numéricos &#8212; MEC301 - Métodos Numéricos</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Repaso Parte 2 - Métodos numéricos basados en series de Taylor" href="../Repaso_Parte2/Repaso_Parte2.html" />
    <link rel="prev" title="Material de repaso" href="../Intro_material_de_repaso.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">MEC301 - Métodos Numéricos</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    Bienvenidos al curso
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Parte 1. Introducción a los métodos numéricos
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../1-Aspectos_generales/1-Aspectos_generales.html">
   1. Aspectos generales de programación y algoritmos
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../2-Algebra_lineal/2-Algebra_lineal.html">
   2. Algebra lineal y sistemas de ecuaciones lineales
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../3-Ajuste_de_curvas/3-Ajuste_de_curvas.html">
   3. Ajuste de curvas por mínimos cuadrados
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../4-Interpolacion/4-Interpolacion.html">
   4. Métodos de Interpolación
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Parte 2. Métodos numéricos basados en series de Taylor
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../5-Taylor-series/5-Taylor-series.html">
   5. Series de Taylor
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../6-Root-finding/6-Root-finding.html">
   6. Algortimos de búsqueda de raíces
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../7-Integracion/7-Integracion.html">
   7. Integración numérica
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Parte 3. Métodos numéricos para ecuaciones diferenciales
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../8-Derivacion_numerica/8-Derivacion_numerica.html">
   8. Derivación numérica
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../9-EDO_valor_inicial/9-EDO_valor_inicial.html">
   9. Ecuaciones Diferenciales Ordinarias - Problema de valor inicial
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Apéndice
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../Intro_material_de_repaso.html">
   Material de repaso
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Repaso Parte 1 -  Introducción a los métodos numéricos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Repaso_Parte2/Repaso_Parte2.html">
     Repaso Parte 2 -  Métodos numéricos basados en series de Taylor
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/Apendice/Repaso/Repaso_Parte1/Repaso_Parte1.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../../_sources/Apendice/Repaso/Repaso_Parte1/Repaso_Parte1.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sistemas-de-ecuaciones-lineales">
   Sistemas de ecuaciones lineales
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solucion-del-sistema-numpy-linalg-solve">
     Solución del sistema (
     <code class="docutils literal notranslate">
      <span class="pre">
       numpy.linalg.solve
      </span>
     </code>
     )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#condicionamiento-de-la-matriz-numpy-linalg-cond">
     Condicionamiento de la matriz (
     <code class="docutils literal notranslate">
      <span class="pre">
       numpy.linalg.cond
      </span>
     </code>
     )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cuantificacion-del-error-numpy-linalg-norm">
     Cuantificación del error (
     <code class="docutils literal notranslate">
      <span class="pre">
       numpy.linalg.norm
      </span>
     </code>
     )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#numero-de-soluciones-posibles-numpy-linalg-matrix-rank">
     Número de soluciones posibles (
     <code class="docutils literal notranslate">
      <span class="pre">
       numpy.linalg.matrix_rank
      </span>
     </code>
     )
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ajuste-por-minimos-cuadrados">
   Ajuste por mínimos cuadrados
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regresion-lineal-numpy-linalg-pinv-o-lstsq">
     Regresión lineal (
     <code class="docutils literal notranslate">
      <span class="pre">
       numpy.linalg.pinv
      </span>
     </code>
     o
     <code class="docutils literal notranslate">
      <span class="pre">
       .lstsq
      </span>
     </code>
     )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regresion-no-lineal-scipy-optimize-curve-fit">
     Regresión no lineal (
     <code class="docutils literal notranslate">
      <span class="pre">
       scipy.optimize.curve_fit
      </span>
     </code>
     )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calidad-del-modelo-sklearn-metrics-r2-score">
     Calidad del modelo (
     <code class="docutils literal notranslate">
      <span class="pre">
       sklearn.metrics.r2_score
      </span>
     </code>
     )
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#interpolacion">
   Interpolación
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interpolacion-polinomimal">
     Interpolación polinomimal
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#generacion-de-polinomios">
       Generación de polinomios
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#comparacion-de-modelos">
       Comparación de modelos
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interpolacion-por-tramos-o-spline-scipy-interpolate">
     Interpolación por tramos o
     <em>
      spline
     </em>
     (
     <code class="docutils literal notranslate">
      <span class="pre">
       scipy.interpolate
      </span>
     </code>
     )
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#extrapolacion-en-interp1d">
       Extrapolación en
       <code class="docutils literal notranslate">
        <span class="pre">
         interp1d
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#condiciones-de-borde-en-cubicspline">
       Condiciones de borde en
       <code class="docutils literal notranslate">
        <span class="pre">
         CubicSpline
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#comparacion-de-modelos-de-interpolacion">
       Comparación de modelos de interpolación
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#precision-en-la-extrapolacion-por-cubicspline">
       Precisión en la extrapolación por
       <code class="docutils literal notranslate">
        <span class="pre">
         CubicSpline
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Repaso Parte 1 -  Introducción a los métodos numéricos</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sistemas-de-ecuaciones-lineales">
   Sistemas de ecuaciones lineales
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solucion-del-sistema-numpy-linalg-solve">
     Solución del sistema (
     <code class="docutils literal notranslate">
      <span class="pre">
       numpy.linalg.solve
      </span>
     </code>
     )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#condicionamiento-de-la-matriz-numpy-linalg-cond">
     Condicionamiento de la matriz (
     <code class="docutils literal notranslate">
      <span class="pre">
       numpy.linalg.cond
      </span>
     </code>
     )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cuantificacion-del-error-numpy-linalg-norm">
     Cuantificación del error (
     <code class="docutils literal notranslate">
      <span class="pre">
       numpy.linalg.norm
      </span>
     </code>
     )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#numero-de-soluciones-posibles-numpy-linalg-matrix-rank">
     Número de soluciones posibles (
     <code class="docutils literal notranslate">
      <span class="pre">
       numpy.linalg.matrix_rank
      </span>
     </code>
     )
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ajuste-por-minimos-cuadrados">
   Ajuste por mínimos cuadrados
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regresion-lineal-numpy-linalg-pinv-o-lstsq">
     Regresión lineal (
     <code class="docutils literal notranslate">
      <span class="pre">
       numpy.linalg.pinv
      </span>
     </code>
     o
     <code class="docutils literal notranslate">
      <span class="pre">
       .lstsq
      </span>
     </code>
     )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regresion-no-lineal-scipy-optimize-curve-fit">
     Regresión no lineal (
     <code class="docutils literal notranslate">
      <span class="pre">
       scipy.optimize.curve_fit
      </span>
     </code>
     )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calidad-del-modelo-sklearn-metrics-r2-score">
     Calidad del modelo (
     <code class="docutils literal notranslate">
      <span class="pre">
       sklearn.metrics.r2_score
      </span>
     </code>
     )
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#interpolacion">
   Interpolación
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interpolacion-polinomimal">
     Interpolación polinomimal
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#generacion-de-polinomios">
       Generación de polinomios
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#comparacion-de-modelos">
       Comparación de modelos
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interpolacion-por-tramos-o-spline-scipy-interpolate">
     Interpolación por tramos o
     <em>
      spline
     </em>
     (
     <code class="docutils literal notranslate">
      <span class="pre">
       scipy.interpolate
      </span>
     </code>
     )
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#extrapolacion-en-interp1d">
       Extrapolación en
       <code class="docutils literal notranslate">
        <span class="pre">
         interp1d
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#condiciones-de-borde-en-cubicspline">
       Condiciones de borde en
       <code class="docutils literal notranslate">
        <span class="pre">
         CubicSpline
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#comparacion-de-modelos-de-interpolacion">
       Comparación de modelos de interpolación
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#precision-en-la-extrapolacion-por-cubicspline">
       Precisión en la extrapolación por
       <code class="docutils literal notranslate">
        <span class="pre">
         CubicSpline
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <p><font size="6">MEC301 - Métodos Numéricos</font></p>
<section class="tex2jax_ignore mathjax_ignore" id="repaso-parte-1-introduccion-a-los-metodos-numericos">
<h1>Repaso Parte 1 -  Introducción a los métodos numéricos<a class="headerlink" href="#repaso-parte-1-introduccion-a-los-metodos-numericos" title="Permalink to this headline">#</a></h1>
<p>Profesor: Francisco Ramírez Cuevas<br></p>
<section id="sistemas-de-ecuaciones-lineales">
<h2>Sistemas de ecuaciones lineales<a class="headerlink" href="#sistemas-de-ecuaciones-lineales" title="Permalink to this headline">#</a></h2>
<p>La librería <code class="docutils literal notranslate"><span class="pre">numpy.linalg</span></code> tiene diversas herramientas para resolver y caracterizar sistemas de ecuaciones en python.</p>
<p>Consideremos un sistema de ecuaciones de la forma</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{eqnarray*}
3x_1 + 1x_2 - 5x_3 &amp;=&amp; 2 \\
-2x_1 - 2x_2 + 5x_3 &amp;=&amp; 5 \\
8x_1 + 1\times10^{10}x_2 + 2x_3 &amp;=&amp; -3 \\
\end{eqnarray*}\]</div>
<section id="solucion-del-sistema-numpy-linalg-solve">
<h3>Solución del sistema (<code class="docutils literal notranslate"><span class="pre">numpy.linalg.solve</span></code>)<a class="headerlink" href="#solucion-del-sistema-numpy-linalg-solve" title="Permalink to this headline">#</a></h3>
<p>Para resolver esto en python, primero debemos escribir el sistema en forma matricial:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">3</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">],</span>
              <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span>  <span class="mi">5</span><span class="p">],</span>
              <span class="p">[</span> <span class="mi">8</span><span class="p">,</span>  <span class="mf">1E10</span><span class="p">,</span>  <span class="mi">2</span><span class="p">]])</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">],</span> 
              <span class="p">[</span><span class="mi">5</span><span class="p">],</span> 
              <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<p>La solución a este sistema se obtiene mediante <code class="docutils literal notranslate"><span class="pre">numpy.linalg.solve</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">xsol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;La solución es x =</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">xsol</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>La solución es x =
 [[ 6.99999999e+00]
 [-6.65999999e-09]
 [ 3.79999999e+00]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="condicionamiento-de-la-matriz-numpy-linalg-cond">
<h3>Condicionamiento de la matriz (<code class="docutils literal notranslate"><span class="pre">numpy.linalg.cond</span></code>)<a class="headerlink" href="#condicionamiento-de-la-matriz-numpy-linalg-cond" title="Permalink to this headline">#</a></h3>
<p>Una forma de caracterizar el sistema es mediante el <strong>número de condición</strong>. En python <code class="docutils literal notranslate"><span class="pre">numpy.linalg.cond</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Número de condicionamiento, cond(A) =&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Número de condicionamiento, cond(A) = 15824113618.647936
</pre></div>
</div>
</div>
</div>
<p>El número de condición está directamente relacionado con el determinante de la matriz. Si <span class="math notranslate nohighlight">\(\mathrm{cond}(A)\)</span> es muy grande, entonces <span class="math notranslate nohighlight">\(\mathrm{det}(A)\approx 0\)</span>. Así:</p>
<p><strong>A mayor número de condicionamiento, mayor es la probabilidad de inducir errores de redondeo, overflow o underflow en la solución.</strong></p>
</section>
<section id="cuantificacion-del-error-numpy-linalg-norm">
<h3>Cuantificación del error (<code class="docutils literal notranslate"><span class="pre">numpy.linalg.norm</span></code>)<a class="headerlink" href="#cuantificacion-del-error-numpy-linalg-norm" title="Permalink to this headline">#</a></h3>
<p>Podemos revisar el error mediante la norma Frobenius. En python, usamos <code class="docutils literal notranslate"><span class="pre">numpy.linalg.norm</span></code></p>
<p>En este ejemplo, comprobamos el error de la solción con <span class="math notranslate nohighlight">\(\|Ax - y\|\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error |A*xsol - y|&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">xsol</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Error |A*xsol - y| 5.329070518200751e-15
</pre></div>
</div>
</div>
</div>
</section>
<section id="numero-de-soluciones-posibles-numpy-linalg-matrix-rank">
<h3>Número de soluciones posibles (<code class="docutils literal notranslate"><span class="pre">numpy.linalg.matrix_rank</span></code>)<a class="headerlink" href="#numero-de-soluciones-posibles-numpy-linalg-matrix-rank" title="Permalink to this headline">#</a></h3>
<p>Para analizar si el sistema tiene solución única, infintas soluciones o no tiene solución, evaluamos los <span class="math notranslate nohighlight">\(\mathrm{rank}(A)\)</span> y <span class="math notranslate nohighlight">\(\mathrm{rank}([A|y])\)</span>, y el número de incognitas <span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>En python usamos <code class="docutils literal notranslate"><span class="pre">numpy.linalg.matrix_rank</span></code> para determinar el rango, y <code class="docutils literal notranslate"><span class="pre">len(y)</span></code> para determinar <span class="math notranslate nohighlight">\(n\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy.linalg</span> <span class="kn">import</span> <span class="n">matrix_rank</span>
<span class="n">Ay</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">A</span><span class="p">,</span><span class="n">y</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># generamos matrix aumentada</span>
<span class="n">rankA</span>  <span class="o">=</span> <span class="n">matrix_rank</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>           <span class="c1"># rango de A</span>
<span class="n">rankAy</span> <span class="o">=</span> <span class="n">matrix_rank</span><span class="p">(</span><span class="n">Ay</span><span class="p">)</span>          <span class="c1"># rago de A|y</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>                        <span class="c1"># número de incognitas</span>

<span class="k">if</span> <span class="n">rankAy</span> <span class="o">==</span> <span class="n">rankA</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">rankA</span> <span class="o">==</span> <span class="n">n</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;El sistema tiene solución única&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">rankA</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;El sistema tiene infinitas soluciones&#39;</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">rankAy</span> <span class="o">==</span> <span class="n">rankA</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;El sistema no tiene soluciones&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>El sistema tiene solución única
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="ajuste-por-minimos-cuadrados">
<h2>Ajuste por mínimos cuadrados<a class="headerlink" href="#ajuste-por-minimos-cuadrados" title="Permalink to this headline">#</a></h2>
<p>Queremos encontrar los parámetros <span class="math notranslate nohighlight">\(\alpha\)</span>, <span class="math notranslate nohighlight">\(\beta\)</span> y <span class="math notranslate nohighlight">\(\rho\)</span> del siguiente modelo:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
U(v,t) = \alpha \frac{(v + 2)^{\beta}}{(t + 3)^{3\rho}}
\end{equation*}\]</div>
<p>que se ajustan mejor a los datos <span class="math notranslate nohighlight">\(v_i\)</span>, <span class="math notranslate nohighlight">\(t_i\)</span> y <span class="math notranslate nohighlight">\(U_i\)</span>, dados por:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">vi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.2363</span><span class="p">,</span>  <span class="mf">0.7447</span><span class="p">,</span>  <span class="mf">0.0632</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7255</span><span class="p">,</span>  <span class="mf">0.1367</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2126</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9105</span><span class="p">,</span>  <span class="mf">0.8601</span><span class="p">,</span>
                <span class="mf">0.7831</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1936</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.085</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.6484</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6699</span><span class="p">,</span>  <span class="mf">0.0654</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4349</span><span class="p">])</span>

<span class="n">ti</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.7537</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7364</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9443</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6301</span><span class="p">,</span>  <span class="mf">0.1792</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6012</span><span class="p">,</span>  <span class="mf">0.3107</span><span class="p">,</span>  <span class="mf">0.1379</span><span class="p">,</span>
               <span class="o">-</span><span class="mf">0.1263</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2106</span><span class="p">,</span>  <span class="mf">0.552</span> <span class="p">,</span>  <span class="mf">0.019</span> <span class="p">,</span>  <span class="mf">0.8273</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0741</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0453</span><span class="p">])</span>

<span class="n">Ui</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.0170</span><span class="p">,</span>  <span class="mf">0.1483</span><span class="p">,</span>  <span class="mf">0.1179</span><span class="p">,</span>  <span class="mf">0.0272</span><span class="p">,</span>  <span class="mf">0.0268</span><span class="p">,</span>  <span class="mf">0.056</span> <span class="p">,</span>  <span class="mf">0.0066</span><span class="p">,</span>  <span class="mf">0.0529</span><span class="p">,</span> 
                <span class="mf">0.0689</span><span class="p">,</span>  <span class="mf">0.0344</span><span class="p">,</span>  <span class="mf">0.0151</span><span class="p">,</span>  <span class="mf">0.0142</span><span class="p">,</span>  <span class="mf">0.0052</span><span class="p">,</span>  <span class="mf">0.0371</span><span class="p">,</span>  <span class="mf">0.0214</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<section id="regresion-lineal-numpy-linalg-pinv-o-lstsq">
<h3>Regresión lineal (<code class="docutils literal notranslate"><span class="pre">numpy.linalg.pinv</span></code> o <code class="docutils literal notranslate"><span class="pre">.lstsq</span></code>)<a class="headerlink" href="#regresion-lineal-numpy-linalg-pinv-o-lstsq" title="Permalink to this headline">#</a></h3>
<p>Una manera de obtener <span class="math notranslate nohighlight">\(\alpha\)</span>, <span class="math notranslate nohighlight">\(\beta\)</span> y <span class="math notranslate nohighlight">\(\rho\)</span> es medinte regresión lineal a partir de un modelo linealizado.</p>
<p><strong>paso 1.</strong> Linealizamos el modelo:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
U(v,t) = \alpha \frac{(v + 2)^{\beta}}{(t + 3)^{3\rho}} \Rightarrow  \ln(U) = \ln(\alpha) + \beta\ln(v + 2) - \rho~ \ln(t+3)^3
\end{equation*}\]</div>
<p>Obtenemos un modelo lineal 2D de la forma <span class="math notranslate nohighlight">\(y = a_0 + a_1x_1 + a_2x_2\)</span>, con:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(y = \ln(U)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(a_0 = \ln(\alpha)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(a_1 = \beta\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(x_1 = \ln(v + 2)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(a_2 = -\rho\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(x_2 = \ln(t+3)^3\)</span></p></li>
</ul>
<p><strong>paso 2.</strong> Transformamos los datos <span class="math notranslate nohighlight">\(v_i\)</span>, <span class="math notranslate nohighlight">\(t_i\)</span> y <span class="math notranslate nohighlight">\(U_i\)</span> al modelo linealizado</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x1i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">vi</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">x2i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">ti</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
<span class="n">yi</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">Ui</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>paso 3.</strong> A partir del modelo general <span class="math notranslate nohighlight">\(y = a_0z_0+a_1z_1+a_2z_2+...a_nz_n\)</span>, creamos la matriz:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
Z =\begin{bmatrix}
1 &amp; x_{1,1} &amp; x_{2,1}\\
1 &amp; x_{1,2} &amp; x_{2,2}\\
\vdots &amp; \vdots &amp; \vdots \\
1 &amp; x_{1,m} &amp; x_{2,m}
\end{bmatrix}
\end{equation*}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">x1i</span><span class="o">**</span><span class="mi">0</span><span class="p">,</span> <span class="n">x1i</span><span class="o">**</span><span class="mi">1</span><span class="p">,</span> <span class="n">x2i</span><span class="o">**</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
</div>
<p><strong>paso 4.</strong> Hacemos ajuste por mínimos cuadrados. En python, a través de la librería <code class="docutils literal notranslate"><span class="pre">numpy.linalg</span></code>, tenemos dos alternativas:</p>
<ul class="simple">
<li><p>Método matriz psudoinversa, <span class="math notranslate nohighlight">\(Z_\mathrm{pinv} = \left(Z^T Z\right)^{-1}Z^T\)</span> (<code class="docutils literal notranslate"><span class="pre">pinv</span></code>)</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Z_pinv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span> <span class="c1"># Matríz Z pseudo inversa</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Z_pinv</span><span class="p">,</span><span class="n">yi</span><span class="p">)</span>      <span class="c1"># Parámetros del modelo lineal</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Mínimos cuadrados (<code class="docutils literal notranslate"><span class="pre">lstsq</span></code>)</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">yi</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># Parámetros del modelo lineal</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">Z</span><span class="p">),</span><span class="n">yi</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;modelo lineal, y = </span><span class="si">%.3f</span><span class="s1"> + </span><span class="si">%.3f</span><span class="s1">x_1 + </span><span class="si">%.3f</span><span class="s1">x_2&#39;</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>modelo lineal, y = -0.959 + 1.973x_1 + -1.184x_2
</pre></div>
</div>
</div>
</div>
<p><strong>paso 5</strong> Extraemos los parámetros del modelo original. En este caso:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\alpha = e^{a_0}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\beta = a_1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\rho = -a_2\)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">beta</span>  <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">rho</span>   <span class="o">=</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;alpha = </span><span class="si">%.3f</span><span class="s1">, beta = </span><span class="si">%.3f</span><span class="s1">, gamma = </span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">rho</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>alpha = 0.383, beta = 1.973, gamma = 1.184
</pre></div>
</div>
</div>
</div>
</section>
<section id="regresion-no-lineal-scipy-optimize-curve-fit">
<h3>Regresión no lineal (<code class="docutils literal notranslate"><span class="pre">scipy.optimize.curve_fit</span></code>)<a class="headerlink" href="#regresion-no-lineal-scipy-optimize-curve-fit" title="Permalink to this headline">#</a></h3>
<p>En el caso de regresión no lineal, el proceso es más sencicllo. En python, ocupamos la función <code class="docutils literal notranslate"><span class="pre">curve_fit</span></code> de la librería <code class="docutils literal notranslate"><span class="pre">scipy.optimize</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>

<span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">):</span>
    <span class="n">U</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="n">b</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">c</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">U</span>
    
<span class="n">xdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">vi</span><span class="p">,</span><span class="n">ti</span><span class="p">))</span>
<span class="n">ydata</span> <span class="o">=</span> <span class="n">Ui</span>

<span class="n">a_nl</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">xdata</span><span class="p">,</span><span class="n">ydata</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;alpha = </span><span class="si">%.3f</span><span class="s1">, beta = </span><span class="si">%.3f</span><span class="s1">, gamma = </span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">a_nl</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">a_nl</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">a_nl</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>alpha = 0.336, beta = 1.925, gamma = 1.126
</pre></div>
</div>
</div>
</div>
</section>
<section id="calidad-del-modelo-sklearn-metrics-r2-score">
<h3>Calidad del modelo (<code class="docutils literal notranslate"><span class="pre">sklearn.metrics.r2_score</span></code>)<a class="headerlink" href="#calidad-del-modelo-sklearn-metrics-r2-score" title="Permalink to this headline">#</a></h3>
<p>Evaluamos la calidad del modelo mediante el coeficiente de determinación. En python usamos la función <code class="docutils literal notranslate"><span class="pre">r2_score</span></code> de <code class="docutils literal notranslate"><span class="pre">sklearn.metrics</span></code>.</p>
<p>Primero creamos una función para nuestro modelo. En este caso crearemos dos funciones:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">U_lin</span></code> para el modelo con los párametros obtenidos por regresión lineal</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">U_nl</span></code> para el modelo con los párametros obtenidos por regresión lineal</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">U_lin</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">v</span><span class="p">,</span><span class="n">t</span><span class="p">:</span> <span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">v</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="n">beta</span><span class="o">/</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">rho</span><span class="p">)</span> <span class="c1"># regresión lineal</span>
<span class="n">U_nl</span>  <span class="o">=</span> <span class="k">lambda</span> <span class="n">v</span><span class="p">,</span><span class="n">t</span><span class="p">:</span> <span class="n">a_nl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">v</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="n">a_nl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">a_nl</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="c1"># regresión no-lineal</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;r2 (reg. lineal) = &#39;</span><span class="p">,</span>    <span class="n">r2_score</span><span class="p">(</span><span class="n">U_lin</span><span class="p">(</span><span class="n">vi</span><span class="p">,</span><span class="n">ti</span><span class="p">),</span> <span class="n">Ui</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;r2 (reg. no-lineal) = &#39;</span><span class="p">,</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">U_nl</span><span class="p">(</span><span class="n">vi</span><span class="p">,</span><span class="n">ti</span><span class="p">)</span> <span class="p">,</span> <span class="n">Ui</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2 (reg. lineal) =  0.9964786187961536
r2 (reg. no-lineal) =  0.9989416972396143
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="interpolacion">
<h2>Interpolación<a class="headerlink" href="#interpolacion" title="Permalink to this headline">#</a></h2>
<p>Queremos generar un polinómio de interpolación para el siguiente set de mediciones:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xi</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">2.9924</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.3285</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.6177</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9819</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.312</span> <span class="p">,</span>  
       <span class="mf">0.3933</span><span class="p">,</span>  <span class="mf">1.0589</span><span class="p">,</span>  <span class="mf">1.7526</span><span class="p">,</span>  <span class="mf">2.3346</span><span class="p">,</span>  <span class="mf">3.0171</span><span class="p">]</span>

<span class="n">yi</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.000e-04</span><span class="p">,</span> <span class="mf">4.400e-03</span><span class="p">,</span> <span class="mf">7.300e-02</span><span class="p">,</span> <span class="mf">3.813e-01</span><span class="p">,</span> <span class="mf">9.072e-01</span><span class="p">,</span> 
      <span class="mf">8.567e-01</span><span class="p">,</span> <span class="mf">3.258e-01</span><span class="p">,</span> <span class="mf">4.630e-02</span><span class="p">,</span> <span class="mf">4.300e-03</span><span class="p">,</span> <span class="mf">1.000e-04</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<section id="interpolacion-polinomimal">
<h3>Interpolación polinomimal<a class="headerlink" href="#interpolacion-polinomimal" title="Permalink to this headline">#</a></h3>
<p>En python tenemos distintos métodos para generar polinomios de interpolación. En el curso vimos 3 métodos:</p>
<ul class="simple">
<li><p>Usando mínimos cuadrados, mediante la librería <code class="docutils literal notranslate"><span class="pre">numpy</span></code>:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">ai</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span><span class="n">yi</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># generamos los coeficientes del polinomio</span>
<span class="n">y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">ai</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>            <span class="c1"># evaluamos el polinomio en x0 para encontrar y0</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Polinomios de Newton, mediante el script <code class="docutils literal notranslate"><span class="pre">newton.py</span></code> desarrollado en clases:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">newton</span> <span class="k">as</span> <span class="nn">nw</span>
<span class="n">ai</span> <span class="o">=</span> <span class="n">nw</span><span class="o">.</span><span class="n">divided_diff</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span><span class="n">yi</span><span class="p">)</span>       <span class="c1"># generamos los coeficientes del polinomio de Newton</span>
<span class="n">y0</span> <span class="o">=</span> <span class="n">nw</span><span class="o">.</span><span class="n">newnton_poly</span><span class="p">(</span><span class="n">ai</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>  <span class="c1"># evaluamos el polinomio en x0 para encontrar y0</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Polinomios de Lagrange, mediante la librería <code class="docutils literal notranslate"><span class="pre">scipy.interpolate</span></code>.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">lagrange</span>
<span class="n">y_interpol</span> <span class="o">=</span> <span class="n">lagrange</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span><span class="n">yi</span><span class="p">)</span>    <span class="c1"># generamos una función de interpolación</span>
<span class="n">y0</span> <span class="o">=</span> <span class="n">y_interpol</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>             <span class="c1"># evaluamos el polinomio en x0 para encontrar y0</span>
</pre></div>
</div>
<p>Notar que tanto el método de regresión lineal como polinomios de newton <strong>se basan en una función para generar los coeficientes</strong> (<code class="docutils literal notranslate"><span class="pre">polyfit</span></code> y <code class="docutils literal notranslate"><span class="pre">divided_diff</span></code>, respectivamente), y <strong>luego otra función para evaluar el polinomio de interpolación</strong> (<code class="docutils literal notranslate"><span class="pre">polyval</span></code> y <code class="docutils literal notranslate"><span class="pre">newton_poly</span></code>, respectivamente)</p>
<p>El método de polinomios de Lagrange, en cambio, <strong>se basa en la función <code class="docutils literal notranslate"><span class="pre">lagrange</span></code> para generar una función de interpolación</strong> (output del tipo “<em>callable</em>” en lenguage python).</p>
<section id="generacion-de-polinomios">
<h4>Generación de polinomios<a class="headerlink" href="#generacion-de-polinomios" title="Permalink to this headline">#</a></h4>
<p>En el siguiente script, utilizamos las tres funciones para generar una <strong>función de interpolación</strong>. Notar que usamos función <code class="docutils literal notranslate"><span class="pre">lambda</span></code> para regresión lineal y polinomios de newton:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">newton</span> <span class="k">as</span> <span class="nn">nw</span> <span class="c1"># funciones del script newton.py</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">lagrange</span>

<span class="c1"># regresión lineal</span>
<span class="n">a_lr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span><span class="n">yi</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>              <span class="c1"># generamos los coeficientes del polinomio</span>
<span class="n">y_linreg</span>   <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">a_lr</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>       <span class="c1"># creamos un output tipo &quot;callable&quot; a través de función lambda</span>

<span class="c1"># polinomios de Newton</span>
<span class="n">a_nw</span> <span class="o">=</span> <span class="n">nw</span><span class="o">.</span><span class="n">divided_diff</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span><span class="n">yi</span><span class="p">)</span>                   <span class="c1"># generamos los coeficientes del polinomio</span>
<span class="n">y_newton</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">nw</span><span class="o">.</span><span class="n">newton_poly</span><span class="p">(</span><span class="n">a_nw</span><span class="p">,</span><span class="n">xi</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="c1"># creamos un output tipo &quot;callable&quot; a través de función lambda</span>

<span class="c1"># polinomios de lagrange   </span>
<span class="n">y_lagrange</span> <span class="o">=</span> <span class="n">lagrange</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span><span class="n">yi</span><span class="p">)</span>                     <span class="c1"># creamos un output tipo &quot;callable&quot;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="comparacion-de-modelos">
<h4>Comparación de modelos<a class="headerlink" href="#comparacion-de-modelos" title="Permalink to this headline">#</a></h4>
<p>Ahora graficamos nuestro resultado para los tres casos en el dominio <span class="math notranslate nohighlight">\(x\in[-3,3]\)</span> generando un arreglo con 100 puntos igualmente espaciados.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>           <span class="c1"># Tamaño de figura</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">})</span> <span class="c1"># Tamaño de fuente</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_linreg</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;-r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Reg. lineal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_newton</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;-m&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Newton&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_lagrange</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;-b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Lagrange&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span><span class="n">yi</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;xi,yi&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/Repaso_Parte1_48_0.png" src="../../../_images/Repaso_Parte1_48_0.png" />
</div>
</div>
</section>
</section>
<section id="interpolacion-por-tramos-o-spline-scipy-interpolate">
<h3>Interpolación por tramos o <em>spline</em> (<code class="docutils literal notranslate"><span class="pre">scipy.interpolate</span></code>)<a class="headerlink" href="#interpolacion-por-tramos-o-spline-scipy-interpolate" title="Permalink to this headline">#</a></h3>
<p>En el caso de interpolación por tramos o “<em>spline</em>, en clases revisamos dos alternativas de la librería <code class="docutils literal notranslate"><span class="pre">scipy.interpolate</span></code>:</p>
<ul class="simple">
<li><p>Interpolación <em>spline</em> lineal mediante <code class="docutils literal notranslate"><span class="pre">interp1d</span></code>:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">interp1d</span>
<span class="n">y_slinear</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span><span class="n">yi</span><span class="p">)</span> <span class="c1"># generamos una función de interpolación</span>
<span class="n">y0</span> <span class="o">=</span> <span class="n">y_slinear</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>          <span class="c1"># evaluamos el polinomio en x0 para encontrar y0</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Interpolación <em>spline</em> cúbico mediante <code class="docutils literal notranslate"><span class="pre">CubicSpline</span></code>:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">CubicSpline</span>
<span class="n">y_scubic</span> <span class="o">=</span> <span class="n">CubicSpline</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span><span class="n">yi</span><span class="p">)</span> <span class="c1"># generamos una función de interpolación</span>
<span class="n">y0</span> <span class="o">=</span> <span class="n">y_scubic</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>             <span class="c1"># evaluamos el polinomio en x0 para encontrar y0</span>
</pre></div>
</div>
<p>En este caso, ámbos métodos generan una <strong>función de interpolación</strong> en formato <em>callable</em></p>
<section id="extrapolacion-en-interp1d">
<h4>Extrapolación en <code class="docutils literal notranslate"><span class="pre">interp1d</span></code><a class="headerlink" href="#extrapolacion-en-interp1d" title="Permalink to this headline">#</a></h4>
<p>Es importante mencionar que, por defecto, <code class="docutils literal notranslate"><span class="pre">interp1d</span></code> arroja un error para <strong>extrapolacion</strong>.</p>
<p>Por ejemplo, en nuestro caso <code class="docutils literal notranslate"><span class="pre">min(xi)</span> <span class="pre">=</span> <span class="pre">-2.9924</span></code>. Así, si evaluamos el polinomio en <code class="docutils literal notranslate"><span class="pre">x0</span> <span class="pre">=</span> <span class="pre">-3</span></code> veremos un error:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">interpolate</span>
<span class="n">y_slinear</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span><span class="n">yi</span><span class="p">)</span> <span class="c1"># generamos una función de interpolación</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_slinear</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">))</span>
<span class="o">...</span>
<span class="o">--&gt;</span> <span class="mi">734</span>             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;A value in x_new is below the interpolation &quot;</span>
    <span class="mi">735</span>                              <span class="s2">&quot;range.&quot;</span><span class="p">)</span>
    <span class="mi">736</span>         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds_error</span> <span class="ow">and</span> <span class="n">above_bounds</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>

<span class="ne">ValueError</span><span class="p">:</span> <span class="n">A</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">x_new</span> <span class="ow">is</span> <span class="n">below</span> <span class="n">the</span> <span class="n">interpolation</span> <span class="nb">range</span><span class="o">.</span>
</pre></div>
</div>
<p>Para suprimir el error agregamos la instrucción <code class="docutils literal notranslate"><span class="pre">bounds_error=False</span></code>. <strong>La función entregará un valor <code class="docutils literal notranslate"><span class="pre">nan</span></code> si el valor está fuera del rango, pero no arrojará un error</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">interp1d</span>
<span class="n">y_slinear</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span><span class="n">yi</span><span class="p">,</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># spline linear con extrapolación</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_slinear</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array(nan)
</pre></div>
</div>
</div>
</div>
</section>
<section id="condiciones-de-borde-en-cubicspline">
<h4>Condiciones de borde en <code class="docutils literal notranslate"><span class="pre">CubicSpline</span></code><a class="headerlink" href="#condiciones-de-borde-en-cubicspline" title="Permalink to this headline">#</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">CubicSpline</span></code> permite especificar las condiciones de borde mediante <code class="docutils literal notranslate"><span class="pre">bc_type</span></code>. Para funciones no periódicas, tenemos:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">CubicSpline</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">CubicSpline</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span><span class="n">yi</span><span class="p">,</span><span class="n">bc_type</span><span class="o">=</span><span class="s1">&#39;not-a-knot&#39;</span><span class="p">)</span> <span class="c1"># Condición de borde not a knot</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">CubicSpline</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span><span class="n">yi</span><span class="p">,</span><span class="n">bc_type</span><span class="o">=</span><span class="s1">&#39;clamped&#39;</span><span class="p">)</span>    <span class="c1"># Condición de borde &quot;clamped&quot;</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">CubicSpline</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span><span class="n">yi</span><span class="p">,</span><span class="n">bc_type</span><span class="o">=</span><span class="s1">&#39;natural&#39;</span><span class="p">)</span>    <span class="c1"># Condición de borde&quot;natural&quot;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">CubicSpline</span></code>, por defecto, permite extrapolar.</p>
<p>Generemos tres tipos de interpolación <em>spline</em> cúbica con extrapolación:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">CubicSpline</span>
<span class="n">y_scubic_nk</span> <span class="o">=</span> <span class="n">CubicSpline</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span><span class="n">yi</span><span class="p">,</span><span class="n">bc_type</span><span class="o">=</span><span class="s1">&#39;not-a-knot&#39;</span><span class="p">)</span>
<span class="n">y_scubic_nat</span> <span class="o">=</span> <span class="n">CubicSpline</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span><span class="n">yi</span><span class="p">,</span><span class="n">bc_type</span><span class="o">=</span><span class="s1">&#39;natural&#39;</span><span class="p">)</span>
<span class="n">y_scubic_cmp</span> <span class="o">=</span> <span class="n">CubicSpline</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span><span class="n">yi</span><span class="p">,</span><span class="n">bc_type</span><span class="o">=</span><span class="s1">&#39;clamped&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="comparacion-de-modelos-de-interpolacion">
<h4>Comparación de modelos de interpolación<a class="headerlink" href="#comparacion-de-modelos-de-interpolacion" title="Permalink to this headline">#</a></h4>
<p>Ahora graficamos todos nuestros resultados en el dominio <span class="math notranslate nohighlight">\(x\in[-3,3]\)</span> generando un arreglo con 100 puntos igualmente espaciados.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>           <span class="c1"># Tamaño de figura</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">})</span> <span class="c1"># Tamaño de fuente</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span>    <span class="n">y_slinear</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;-r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;lineal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span>  <span class="n">y_scubic_nk</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;-b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;cúbico (not-a-knot)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_scubic_nat</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;-g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;cúbico (natural)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_scubic_cmp</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;-m&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;cúbico (clamped)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span><span class="n">yi</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;xi,yi&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/Repaso_Parte1_64_0.png" src="../../../_images/Repaso_Parte1_64_0.png" />
</div>
</div>
</section>
<section id="precision-en-la-extrapolacion-por-cubicspline">
<h4>Precisión en la extrapolación por <code class="docutils literal notranslate"><span class="pre">CubicSpline</span></code><a class="headerlink" href="#precision-en-la-extrapolacion-por-cubicspline" title="Permalink to this headline">#</a></h4>
<p>Las condiciones de borde en <code class="docutils literal notranslate"><span class="pre">CubicSpline</span></code> son importantes al momento de identificar la precisión de la extrapolación. Por ejemplo, evaluemos el error para la extrapolación en <code class="docutils literal notranslate"><span class="pre">x0</span> <span class="pre">=</span> <span class="pre">4</span></code>. En este caso, el valor exácto está dado por <span class="math notranslate nohighlight">\(f(4) = e^{-4^2} = 1.12532\times 10^{-7}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x0</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">y_exact</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error absoluto en &#39;not-a-knot&#39;: </span><span class="si">%.5e</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">abs</span><span class="p">(</span><span class="n">y_exact</span> <span class="o">-</span> <span class="n">y_scubic_nk</span><span class="p">(</span><span class="n">x0</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error absoluto en &#39;natural&#39;: </span><span class="si">%.5e</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">abs</span><span class="p">(</span><span class="n">y_exact</span> <span class="o">-</span> <span class="n">y_scubic_nat</span><span class="p">(</span><span class="n">x0</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error absoluto en &#39;clamped&#39;: </span><span class="si">%.5e</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">abs</span><span class="p">(</span><span class="n">y_exact</span> <span class="o">-</span> <span class="n">y_scubic_cmp</span><span class="p">(</span><span class="n">x0</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Error absoluto en &#39;not-a-knot&#39;: 2.65274e-01
Error absoluto en &#39;natural&#39;: 1.17985e-02
Error absoluto en &#39;clamped&#39;: 8.74198e-03
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Apendice/Repaso/Repaso_Parte1"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../Intro_material_de_repaso.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Material de repaso</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../Repaso_Parte2/Repaso_Parte2.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Repaso Parte 2 -  Métodos numéricos basados en series de Taylor</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Francisco V. Ramirez-Cuevas<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>